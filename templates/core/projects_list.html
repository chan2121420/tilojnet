{% extends 'base.html' %}
{% load static %}

{% block content %}

<section style="min-height: 60vh; display: flex; align-items: center; margin-top: 76px; background: var(--off-white);">
    <div class="container-narrow" style="text-align: center;">
        <h1 class="fade-in-up" style="margin-bottom: var(--space-md);">Portfolio</h1>
        <p class="lead fade-in-up delay-1">
            A curated selection of completed projects across residential and commercial sectors.
        </p>
    </div>
</section>

<section style="background: var(--pure-white); padding: var(--space-md) 0; border-bottom: 1px solid var(--light-grey);">
    <div class="container">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: var(--space-md);">
            <div>
                <span style="font-size: 0.875rem; color: var(--warm-grey);">{{ projects.paginator.count }} Projects</span>
            </div>
            <div style="display: flex; gap: var(--space-md); flex-wrap: wrap;">
                <a href="{% url 'projects_list' %}" style="font-size: 0.875rem; text-decoration: none; color: {% if not active_category %}var(--charcoal){% else %}var(--warm-grey){% endif %}; letter-spacing: 0.05em; text-transform: uppercase;">All</a>
                {% for cat in categories %}
                <a href="?category={{ cat.slug }}" style="font-size: 0.875rem; text-decoration: none; color: {% if active_category == cat.slug %}var(--charcoal){% else %}var(--warm-grey){% endif %}; letter-spacing: 0.05em; text-transform: uppercase;">{{ cat.name }}</a>
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container">
        {% if projects %}
        <div style="display: grid; gap: var(--space-xl);">
            {% for project in projects %}
            <a href="{% url 'project_detail' project.slug %}" style="display: grid; grid-template-columns: 1.2fr 1fr; gap: var(--space-lg); align-items: center; text-decoration: none; color: inherit; padding-bottom: var(--space-xl); border-bottom: 1px solid var(--light-grey); {% if forloop.counter|divisibleby:2 %}direction: rtl;{% endif %}">
                <div style="overflow: hidden;">
                    <img src="{{ project.featured_image.url }}" alt="{{ project.title }}" style="width: 100%; height: 500px; object-fit: cover; transition: var(--transition-smooth);">
                </div>
                <div style="{% if forloop.counter|divisibleby:2 %}direction: ltr;{% endif %}">
                    <div style="display: flex; gap: var(--space-sm); margin-bottom: var(--space-sm);">
                        {% if project.category %}
                        <span style="font-size: 0.75rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--warm-grey);">{{ project.category.name }}</span>
                        {% endif %}
                        {% if project.project_date %}
                        <span style="font-size: 0.75rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--warm-grey);">{{ project.project_date|date:"Y" }}</span>
                        {% endif %}
                    </div>
                    <h2 style="font-size: 2.5rem; margin-bottom: var(--space-sm);">{{ project.title }}</h2>
                    <p style="font-size: 0.875rem; color: var(--warm-grey); margin-bottom: var(--space-sm);">{{ project.location }}</p>
                    <p style="margin-bottom: var(--space-md);">{{ project.short_description|truncatewords:30 }}</p>
                    <span class="btn-text">View Project</span>
                </div>
            </a>
            {% endfor %}
        </div>
        
        <!-- Pagination -->
        {% if projects.has_other_pages %}
        <div style="display: flex; justify-content: center; gap: var(--space-sm); margin-top: var(--space-xl);">
            {% if projects.has_previous %}
            <a href="?page={{ projects.previous_page_number }}{% if active_category %}&category={{ active_category }}{% endif %}" style="padding: 0.5rem 1rem; border: 1px solid var(--light-grey); text-decoration: none; color: var(--charcoal); font-size: 0.875rem;">Previous</a>
            {% endif %}
            
            <span style="padding: 0.5rem 1rem; font-size: 0.875rem; color: var(--warm-grey);">Page {{ projects.number }} of {{ projects.paginator.num_pages }}</span>
            
            {% if projects.has_next %}
            <a href="?page={{ projects.next_page_number }}{% if active_category %}&category={{ active_category }}{% endif %}" style="padding: 0.5rem 1rem; border: 1px solid var(--light-grey); text-decoration: none; color: var(--charcoal); font-size: 0.875rem;">Next</a>
            {% endif %}
        </div>
        {% endif %}
        
        {% else %}
        <div style="text-align: center; padding: var(--space-xl) 0;">
            <p class="lead" style="margin-bottom: var(--space-md);">No projects match your criteria.</p>
            <a href="{% url 'projects_list' %}" class="btn-secondary">View All Projects</a>
        </div>
        {% endif %}
    </div>
</section>

<!-- ============================================
     CTA
     ============================================ -->
<section style="background: var(--charcoal); color: var(--pure-white); padding: var(--space-2xl) 0;">
    <div class="container-narrow" style="text-align: center;">
        <h2 style="color: var(--pure-white); margin-bottom: var(--space-md);">Discuss Your Project</h2>
        <p class="lead" style="color: rgba(255, 255, 255, 0.8); margin-bottom: var(--space-lg);">
            We'd welcome the opportunity to understand your requirements and explore how we can help.
        </p>
        <a href="{% url 'quote_request' %}" class="btn-primary" style="background: var(--pure-white); color: var(--charcoal);">Request Consultation</a>
    </div>
</section>

<style>
/* Project hover effect */
section a[href*="project_detail"]:hover img {
    transform: scale(1.05);
}

@media (max-width: 768px) {
    section a[href*="project_detail"] {
        grid-template-columns: 1fr !important;
        direction: ltr !important;
    }
    
    section a[href*="project_detail"] > div:first-child {
        order: 1;
    }
    
    section a[href*="project_detail"] > div:last-child {
        order: 2;
        direction: ltr !important;
    }
}
</style>

{% endblock %}
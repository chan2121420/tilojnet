{% extends 'base.html' %}
{% load static %}

{% block content %}

<section style="min-height: 70vh; display: flex; align-items: center; margin-top: 76px; position: relative; overflow: hidden;">
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;">
        <img src="{% if category.banner_image %}{{ category.banner_image.url }}{% else %}{{ category.featured_image.url }}{% endif %}" alt="{{ category.name }}" style="width: 100%; height: 100%; object-fit: cover; filter: brightness(0.4);">
    </div>
    <div class="container" style="position: relative; z-index: 1;">
        <div style="max-width: 800px;">
            <div style="font-size: 0.75rem; letter-spacing: 0.1em; text-transform: uppercase; color: rgba(255, 255, 255, 0.7); margin-bottom: var(--space-sm);">Service</div>
            <h1 class="fade-in-up" style="color: var(--pure-white); margin-bottom: var(--space-md);">
                {{ category.name }}
            </h1>
            <p class="lead fade-in-up delay-1" style="color: rgba(255, 255, 255, 0.9); margin-bottom: var(--space-lg); max-width: 600px;">
                {{ category.description }}
            </p>
            <div class="fade-in-up delay-2" style="display: flex; gap: var(--space-md); flex-wrap: wrap;">
                <span style="font-size: 0.875rem; color: rgba(255, 255, 255, 0.8); padding: 0.75rem 1.5rem; border: 1px solid rgba(255, 255, 255, 0.3);">{{ items.count }} Design Option{{ items.count|pluralize }}</span>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="container">
        {% if items %}
        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: var(--space-lg);">
            {% for item in items %}
            <a href="{% url 'category_item_detail' category.slug item.slug %}" style="text-decoration: none; color: inherit; display: block; transition: var(--transition-smooth);">
                <div style="margin-bottom: var(--space-md); overflow: hidden; position: relative;">
                    <img src="{{ item.featured_image.url }}" alt="{{ item.name }}" style="width: 100%; height: 400px; object-fit: cover; transition: var(--transition-smooth);">
                    {% if item.is_popular or item.is_new %}
                    <div style="position: absolute; top: var(--space-sm); right: var(--space-sm); display: flex; flex-direction: column; gap: 0.5rem;">
                        {% if item.is_new %}
                        <span style="background: var(--charcoal); color: var(--pure-white); padding: 0.5rem 1rem; font-size: 0.75rem; letter-spacing: 0.05em; text-transform: uppercase;">New</span>
                        {% endif %}
                        {% if item.is_popular %}
                        <span style="background: var(--gold-accent); color: var(--charcoal); padding: 0.5rem 1rem; font-size: 0.75rem; letter-spacing: 0.05em; text-transform: uppercase;">Popular</span>
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
                <h3 style="font-size: 1.5rem; margin-bottom: var(--space-sm);">{{ item.name }}</h3>
                <p style="font-size: 0.875rem; color: var(--warm-grey); margin-bottom: var(--space-sm);">{{ item.short_description|truncatewords:20 }}</p>
                {% if item.price_range %}
                <p style="font-size: 0.875rem; color: var(--charcoal); margin-bottom: var(--space-sm);">{{ item.price_range }}</p>
                {% endif %}
            </a>
            {% endfor %}
        </div>
        {% else %}
        <div style="text-align: center; padding: var(--space-xl) 0;">
            <p class="lead" style="margin-bottom: var(--space-md);">No design options available yet for this category.</p>
            <a href="{% url 'categories_list' %}" class="btn-secondary">View All Services</a>
        </div>
        {% endif %}
    </div>
</section>

{% if related_projects %}
<section style="background: var(--off-white); padding: var(--space-2xl) 0;">
    <div class="container">
        <div class="container-narrow" style="text-align: center; margin-bottom: var(--space-xl);">
            <h2 style="margin-bottom: var(--space-md);">{{ category.name }} Projects</h2>
            <p class="lead">Completed projects featuring {{ category.name|lower }} design.</p>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--space-md);">
            {% for project in related_projects|slice:":3" %}
            <a href="{% url 'project_detail' project.slug %}" style="display: block; text-decoration: none; color: inherit; position: relative; overflow: hidden; height: 400px;">
                <img src="{{ project.featured_image.url }}" alt="{{ project.title }}" style="width: 100%; height: 100%; object-fit: cover; transition: var(--transition-smooth);">
                <div style="position: absolute; bottom: 0; left: 0; right: 0; padding: var(--space-md); background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); color: var(--pure-white);">
                    <div style="font-size: 0.75rem; letter-spacing: 0.05em; text-transform: uppercase; margin-bottom: 0.5rem; color: var(--gold-accent);">{{ project.category.name }}</div>
                    <h4 style="color: var(--pure-white); margin-bottom: 0.5rem;">{{ project.title }}</h4>
                    <p style="font-size: 0.875rem; color: rgba(255, 255, 255, 0.8);">{{ project.location }}</p>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- ============================================
     CTA
     ============================================ -->
<section class="section">
    <div class="container-narrow" style="text-align: center;">
        <h2 style="margin-bottom: var(--space-md);">Interested in {{ category.name }}?</h2>
        <p class="lead" style="margin-bottom: var(--space-lg);">
            Schedule a consultation to discuss your {{ category.name|lower }} requirements.
        </p>
        <a href="{% url 'quote_request' %}" class="btn-primary">Request Consultation</a>
    </div>
</section>

<style>
/* Item hover effects */
section a[href*="category_item_detail"]:hover img {
    transform: scale(1.05);
}

section a[href*="project_detail"]:hover img {
    transform: scale(1.1);
}

@media (max-width: 768px) {
    section div[style*="grid-template-columns: repeat(auto-fill, minmax(350px, 1fr))"] {
        grid-template-columns: 1fr !important;
    }
}
</style>

{% endblock %}